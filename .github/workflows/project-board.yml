name: Project Board Automation

on:
  issues:
    types: [opened]
  pull_request:
    types: [opened]

permissions:
  issues: write
  pull-requests: write

jobs:
  project_automation:
    runs-on: ubuntu-latest
    steps:
      - name: Add to Project Board
        uses: actions/add-to-project@v1.0.0
        with:
          project-url: https://github.com/orgs/AICryptopia/projects/1
          github-token: ${{ secrets.GITHUB_TOKEN }}

      - name: Add Labels
        uses: actions/github-script@v7
        with:
          script: |
            const addLabels = async () => {
              if (context.eventName === 'issues') {
                const issue = context.payload.issue;
                const title = issue.title.toLowerCase();
                const labels = ['BUILD'];

                if (title.startsWith('[feature]')) {
                  labels.push('âœ¨ Type: Feature');
                } else if (title.startsWith('[bug]')) {
                  labels.push('ğŸ› Type: Bug');
                } else if (title.startsWith('[docs]')) {
                  labels.push('ğŸ“š Type: Documentation');
                } else if (title.startsWith('[maintenance]')) {
                  labels.push('ğŸ”§ Type: Maintenance');
                }

                await github.rest.issues.addLabels({
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  issue_number: issue.number,
                  labels: labels
                });
              }
            };
            
            await addLabels(); 